/Users/lan/Desktop/code/ai_sentiney/src/analyst/gemini_client.py:1: FutureWarning: 

All support for the `google.generativeai` package has ended. It will no longer be receiving 
updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
See README for more details:

https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md

  import google.generativeai as genai
[32m14:43:39 [INFO] sentinel: Configuration loaded successfully.[0m
[32m14:43:39 [INFO] sentinel: === Starting Analysis (MIDDAY) ===[0m
[32m14:43:39 [INFO] sentinel: Circuit breaker states loaded from disk.[0m
[32m14:43:39 [INFO] sentinel: Starting Batch Data Collection (Dual Source)...[0m
[31m14:43:44 [ERROR] sentinel: Command fetch_spot_data timed out after 5s.[0m
[33m14:43:44 [WARNING] sentinel: Source Efinance failed for fetch_spot_data: [0m
[33m14:43:44 [WARNING] sentinel: Circuit Breaker: Efinance OPEN after 3 consecutive failures. Will retry in 30.0s.[0m
/Users/lan/Desktop/code/ai_sentiney/.venv/lib/python3.13/site-packages/requests/utils.py:1046: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x1087a4f40>
  if not validator.match(header_part):
ResourceWarning: Enable tracemalloc to get the object allocation traceback
  0%|          | 0/58 [00:00<?, ?it/s]  2%|â–         | 1/58 [00:01<01:09,  1.21s/it]  3%|â–         | 2/58 [00:03<01:39,  1.78s/it][31m14:43:49 [ERROR] sentinel: Command fetch_spot_data timed out after 5s.[0m
[33m14:43:49 [WARNING] sentinel: Source AkShare failed for fetch_spot_data: [0m
[33m14:43:49 [WARNING] sentinel: Circuit Breaker: AkShare OPEN after 3 consecutive failures. Will retry in 30.0s.[0m
[31m14:43:49 [ERROR] sentinel: All sources failed for fetch_spot_data.[0m
[33m14:43:49 [WARNING] sentinel: All sources failed to fetch bulk spot data. Will rely on individual fetch.[0m
[32m14:43:49 [INFO] sentinel: Fetching market breadth...[0m
[32m14:43:49 [INFO] sentinel: Fetching Northbound funds...[0m
[32m14:43:49 [INFO] sentinel: Fetching macro news...[0m

  0%|          | 0/8 [00:00<?, ?it/s][A
 12%|â–ˆâ–        | 1/8 [00:00<00:00,  7.70it/s][A
 25%|â–ˆâ–ˆâ–Œ       | 2/8 [00:00<00:00,  7.23it/s][A
 38%|â–ˆâ–ˆâ–ˆâ–Š      | 3/8 [00:00<00:00,  7.18it/s][A

0it [00:00, ?it/s][A[A

                  [A[A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4/8 [00:00<00:01,  3.21it/s][A

  0%|          | 0/14 [00:00<?, ?it/s][A[A
 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 5/8 [00:01<00:00,  4.04it/s][A

  7%|â–‹         | 1/14 [00:00<00:01,  7.53it/s][A[A  5%|â–Œ         | 3/58 [00:06<02:03,  2.24s/it]
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6/8 [00:01<00:00,  4.67it/s][A

 14%|â–ˆâ–        | 2/14 [00:00<00:01,  7.03it/s][A[A
 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7/8 [00:01<00:00,  5.24it/s][A

 21%|â–ˆâ–ˆâ–       | 3/14 [00:00<00:01,  6.98it/s][A[A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:01<00:00,  6.17it/s][A
                                             [A

 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 5/14 [00:00<00:01,  8.68it/s][A[A

 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 6/14 [00:00<00:00,  8.88it/s][A[A

 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 7/14 [00:00<00:00,  9.01it/s][A[A

 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 8/14 [00:00<00:00,  9.00it/s][A[A

 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 9/14 [00:01<00:00,  5.35it/s][A[A

 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 10/14 [00:01<00:00,  5.50it/s][A[A

 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 11/14 [00:01<00:00,  5.51it/s][A[A

 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 12/14 [00:01<00:00,  5.03it/s][A[A  7%|â–‹         | 4/58 [00:08<01:53,  2.10s/it]

 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 13/14 [00:02<00:00,  4.26it/s][A[A

100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14/14 [00:02<00:00,  3.99it/s][A[A

                                               [A[A[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sh510500[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sh512480[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sh588760[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sh563300[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sz159819[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sz159934[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sh510300[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sz159338[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sh560780[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sh510980[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sh601899[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sz000603[0m
[32m14:43:53 [INFO] sentinel: Tencent Fetching Single Quote: http://qt.gtimg.cn/q=sh600089[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 000603 -> 47.19 (-3.46%) Vol:266039.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 510980 -> 1.434 (0.07%) Vol:158992.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 512480 -> 1.637 (0.55%) Vol:6009505.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 563300 -> 1.512 (0.0%) Vol:1880942.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 510300 -> 4.731 (0.08%) Vol:6124057.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 510500 -> 8.382 (-0.15%) Vol:2952247.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 159338 -> 1.25 (0.16%) Vol:44143479.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 588760 -> 0.851 (2.04%) Vol:1809954.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 560780 -> 2.008 (-0.2%) Vol:495917.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 600089 -> 27.85 (-0.78%) Vol:1250394.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 159819 -> 1.601 (0.82%) Vol:2302599.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 601899 -> 38.73 (0.26%) Vol:1858219.0[0m
[32m14:43:53 [INFO] sentinel: âœ… Tencent Quote Success: 159934 -> 11.164 (-0.41%) Vol:1566280.0[0m
[32m14:43:53 [INFO] sentinel: Data Collected. Market Breadth: N/A (Tencent), North Funds: 0.0[0m
[32m14:43:53 [INFO] sentinel: Initializing Gemini Client with model: gemini-3-pro-preview[0m
[32m14:43:53 [INFO] sentinel: Sending request to Gemini...[0m
                                              [31m14:43:59 [ERROR] sentinel: AkShare spot fetch failed: HTTPSConnectionPool(host='82.push2.eastmoney.com', port=443): Max retries exceeded with url: /api/qt/clist/get?pn=6&pz=100&po=1&np=1&ut=bd1d9ddb04089700cf9c27f6f7426281&fltt=2&invt=2&fid=f12&fs=m%3A0+t%3A6%2Cm%3A0+t%3A80%2Cm%3A1+t%3A2%2Cm%3A1+t%3A23%2Cm%3A0+t%3A81+s%3A2048&fields=f1%2Cf2%2Cf3%2Cf4%2Cf5%2Cf6%2Cf7%2Cf8%2Cf9%2Cf10%2Cf12%2Cf13%2Cf14%2Cf15%2Cf16%2Cf17%2Cf18%2Cf20%2Cf21%2Cf23%2Cf24%2Cf25%2Cf22%2Cf11%2Cf62%2Cf128%2Cf136%2Cf115%2Cf152 (Caused by ProxyError('Unable to connect to proxy', RemoteDisconnected('Remote end closed connection without response')))[0m
[31m14:44:11 [ERROR] sentinel: Efinance spot fetch failed: Expecting value: line 1 column 1 (char 0)[0m
[32m14:44:45 [INFO] sentinel: Schema validation passed: 13 actions[0m
[32m14:44:45 [INFO] sentinel: Midday Analysis Completed.[0m
[32m14:44:45 [INFO] sentinel: Publish not requested: Skipping Feishu Push.[0m
[32m14:44:45 [INFO] sentinel: âœ… Saved midday record to DB for 2026-02-10.[0m
[32m14:44:45 [INFO] sentinel: === Analysis (MIDDAY) Finished ===[0m
=== åˆç›˜åˆ†æ ===
æƒ…ç»ª: åˆ†æ­§ (ç¼©é‡æ•´å›º)
é‡èƒ½: ç¼©é‡é˜´è·Œ (ä¹°ç›˜åŒ®ä¹)
æŒ‡æ•°: ä¸Šè¯æŒ‡æ•° +0.142% / æ·±è¯æˆæŒ‡ +0.074% / åˆ›ä¸šæ¿æŒ‡ -0.258%
ç‚¹è¯„: æŒ‡æ•°çª„å¹…éœ‡è¡ï¼Œå…¨å¸‚åœºé‡èƒ½æ˜¾è‘—èç¼©ï¼ˆå¤šåªETFé‡æ¯”<0.5ï¼‰ã€‚å½“å‰å±äº'æ— é‡ç©ºè·Œ'çš„åƒåœ¾æ—¶é—´ï¼Œä¸»åŠ›èµ„é‡‘å¤„äºè§‚æœ›çŠ¶æ€ã€‚MA20å‡çº¿é™„è¿‘è™½æœ‰åå¤ï¼Œä½†å› ç¼ºä¹æŠ›å‹ï¼Œç³»ç»Ÿæ€§é£é™©ä¸å¤§ã€‚ç­–ç•¥ä¸Šä¸¥ç¦è¿½æ¶¨ï¼Œå¯¹ç¼©é‡å›è¸©MA20çš„å“ç§ä¿æŒè€å¿ƒï¼Œè­¦æƒ•æ— é‡é˜´è·Œä¸ªè‚¡çš„æµåŠ¨æ€§é™·é˜±ã€‚
  [510500] ä¸­è¯500ETF `ğŸŸ¢ -0.15%` | ä¿¡å·:WATCH | æ“ä½œ:è§‚æœ› (ç­‰å¾…æ”¶å›)
    ç†ç”±: ä»·è·Œç ´MA20(8.40)ï¼Œä½†é‡æ¯”æä½(0.34)ï¼Œå…¸å‹'æ— é‡å‡æ‘”'ã€‚ä¸‹è·Œæ— åŠ¨èƒ½ï¼Œç­‰å¾…ä¸‹åˆèµ„é‡‘å›æµä¿®å¤ã€‚
  [512480] åŠå¯¼ä½“ETF `ğŸ”´ +0.55%` | ä¿¡å·:WATCH | æ“ä½œ:åšT/è§‚æœ›
    ç†ç”±: åå¼¹å—é˜»äºMA20(1.67)ï¼Œé‡æ¯”0.68æ˜¾ç¤ºæ”»å‡»æ„æ„¿ä¸è¶³ã€‚å±äºå¼±åŠ¿éœ‡è¡ï¼Œæš‚ä¸åŠ ä»“ã€‚
  [588760] ç§‘åˆ›äººå·¥æ™ºèƒ½ETF `ğŸ”´ +2.04%` | ä¿¡å·:OBSERVED | æ“ä½œ:é”ä»“
    ç†ç”±: å¼ºåŠ¿åå¼¹(+2.04%)é€¼è¿‘MA20(0.86)ï¼Œè™½ç„¶æœªçªç ´ï¼Œä½†åŠ¿å¤´å¼ºäºå¤§ç›˜ã€‚éœ€è§‚å¯Ÿä¸‹åˆæ˜¯å¦è¡¥é‡å†²å…³ã€‚
  [563300] ä¸­è¯2000ETF `ğŸŸ¢ 0.0%` | ä¿¡å·:SAFE | æ“ä½œ:é”ä»“
    ç†ç”±: ä»·æ ¼(1.51)ç¨³å®ˆMA20(1.50)ä¸Šæ–¹ï¼Œå°å¾®ç›˜è‚¡æƒ…ç»ªç¨³å®šï¼Œè¶‹åŠ¿å®Œå¥½ã€‚
  [159819] äººå·¥æ™ºèƒ½ETF `ğŸ”´ +0.82%` | ä¿¡å·:WATCH | æ“ä½œ:è§‚æœ›
    ç†ç”±: ç¼©é‡å›è°ƒï¼Œå—åˆ¶äºMA20ï¼Œä¸ç§‘åˆ›AIèµ°åŠ¿åˆ†åŒ–ï¼Œæš‚ä¸åŠ¨ã€‚
  [159934] é»„é‡‘ETF `ğŸŸ¢ -0.41%` | ä¿¡å·:SAFE | æ“ä½œ:é”ä»“
    ç†ç”±: ç¼©é‡(é‡æ¯”0.35)æ­£å¸¸å›è°ƒï¼Œæ”¶ç›˜ä»·(11.16)è¿œé«˜äºMA20(11.0)ï¼Œä¸Šå‡é€šé“å®Œæ•´ï¼Œæ— è§†çŸ­æœŸæ³¢åŠ¨ã€‚
  [510300] æ²ªæ·±300ETF `ğŸ”´ +0.08%` | ä¿¡å·:SAFE | æ“ä½œ:é”ä»“
    ç†ç”±: ç«™ç¨³MA20ï¼Œä½œä¸ºæƒé‡åº•ä»“ï¼Œåªè¦ä¸æ”¾é‡ä¸‹è·Œå³è§†ä¸ºå®‰å…¨ã€‚
  [159338] ä¸­è¯A500ETF `ğŸ”´ +0.16%` | ä¿¡å·:OBSERVED | æ“ä½œ:è§‚æœ›
    ç†ç”±: ä»·æ ¼(1.25)ç²¾å‡†å¡ä½MA20ï¼Œå¤šç©ºå¹³è¡¡ç‚¹ã€‚é‡æ¯”0.8ç›¸å¯¹æ¸©å’Œï¼Œç­‰å¾…æ–¹å‘é€‰æ‹©ã€‚
  [560780] åŠå¯¼ä½“è®¾å¤‡ETF `ğŸŸ¢ -0.2%` | ä¿¡å·:WATCH | æ“ä½œ:è§‚æœ›
    ç†ç”±: è·Œç ´MA20ï¼Œå½¢æ€åå¼±ï¼Œä½†ä¹Ÿæ˜¯ç¼©é‡çŠ¶æ€ï¼Œæœªè§ææ…Œç›˜ã€‚
  [510980] ä¸Šè¯æŒ‡æ•°ETF `ğŸ”´ +0.07%` | ä¿¡å·:SAFE | æ“ä½œ:é”ä»“
    ç†ç”±: å¤§ç›˜æŒ‡æ•°æœ¬èº«è¿è¡Œåœ¨MA20ä¸Šæ–¹ï¼Œç³»ç»Ÿç¯å¢ƒç›¸å¯¹å®‰å…¨ã€‚
  [601899] ç´«é‡‘çŸ¿ä¸š `ğŸ”´ +0.26%` | ä¿¡å·:OBSERVED | æ“ä½œ:é”ä»“
    ç†ç”±: ä»·æ ¼(38.73)ç´§è´´MA20(38.74)ï¼Œè™½ç„¶å¾®ç ´1åˆ†é’±ï¼Œä½†é‡æ¯”0.57æå…¶èç¼©ï¼Œä¸»åŠ›å¹¶æœªå‡ºé€ƒï¼Œè§†ä¸ºæ´—ç›˜ã€‚
  [000603] ç››è¾¾èµ„æºï¼ˆç™½é“¶ï¼‰ `ğŸŸ¢ -3.46%` | ä¿¡å·:WARNING | æ“ä½œ:åšåå¼¹å‡ä»“
    ç†ç”±: è·Œå¹…-3.46%ä¸”ä¹–ç¦»ç‡-6.5%ï¼Œå½¢æ€æ¶åŠ£ã€‚å”¯ä¸€æ­£é¢æ˜¯é‡æ¯”0.51ï¼ˆæ— é‡ä¸‹è·Œï¼‰ã€‚åˆ¤å®šä¸ºæƒ…ç»ªæ€§æ€è·Œï¼Œå»ºè®®åˆ©ç”¨ç›˜ä¸­åæŠ½å‡ä»“ï¼Œè‹¥æ— åæŠ½ä¹Ÿä¸å®œåœ¨æ·±è·Œå¤„å‰²è‚‰ã€‚
  [600089] ç‰¹å˜ç”µå·¥ `ğŸŸ¢ -0.78%` | ä¿¡å·:WATCH | æ“ä½œ:è§‚æœ›
    ç†ç”±: å—åˆ¶äºMA20ï¼Œé‡èƒ½ä½è¿·ï¼Œç¼ºä¹ç‹¬ç«‹è¡Œæƒ…ï¼Œéšæ¿å—æ³¢åŠ¨ã€‚
<sys>:0: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x1087a5a80>
ResourceWarning: Enable tracemalloc to get the object allocation traceback
<sys>:0: ResourceWarning: unclosed database in <sqlite3.Connection object at 0x1087a53f0>
ResourceWarning: Enable tracemalloc to get the object allocation traceback
